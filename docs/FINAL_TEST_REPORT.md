# グラニュート文字OCR テスト最終報告書

## テスト概要
- **テスト画像**: test_data/test.png
- **実際の文字列**: PLEASURE
- **認識結果**: BDEPQYYZ

## 成果と課題

### 成果
1. **文字分割の改善**: 
   - 初期: 12文字（過剰分割）
   - 改善後: 8文字（正確な分割）✓
   - 水平プロジェクション分析により正確な文字境界検出を実現

2. **システム統合**:
   - CNN（95%精度）、Tesseract（61.5%精度）、Hash-based（28.5%精度）の3つの認識手法を統合
   - 優先順位: CNN → Tesseract → Hash-based

### 課題
1. **認識精度**: 8文字中1文字のみ正解（12.5%）
   - P → B（CNN、36%信頼度）
   - L → D（CNN、34%信頼度）
   - E → E（Tesseract、70%信頼度）✓
   - A → P（Tesseract、70%信頼度）
   - S → Q（Tesseract、70%信頼度）
   - U → Y（Tesseract、70%信頼度）
   - R → Y（Tesseract、70%信頼度）
   - E → Z（Tesseract、70%信頼度）

2. **CNNの低信頼度**: 実際のテキスト画像では信頼度が30-40%程度

## 原因分析

### 1. 訓練データと実画像の乖離
- **訓練データ**: 個別に抽出された単一文字画像（紫色の丸い背景）
- **実画像**: 連続テキストから切り出された文字（異なる形状・品質）

### 2. グラニュート文字の特殊性
- 複雑な形状により、文字の一部が分離する
- 通常のアルファベットとは異なる特徴を持つ

### 3. 前処理の不一致
- 訓練時と推論時で異なる前処理が適用されている可能性

## 改善提案

### 短期的改善
1. **前処理の最適化**
   - 訓練データと同じ条件での前処理
   - ノイズ除去とコントラスト調整の改善

2. **閾値の調整**
   - CNN信頼度の閾値を0.3から更に下げる
   - 文字ごとの個別調整

### 長期的改善
1. **End-to-End学習**
   - 実際のグラニュート文字テキスト画像での再訓練
   - 文字分割と認識を同時に学習

2. **データ拡張**
   - より多様な背景・照明条件での訓練データ生成
   - 実画像に近い条件でのデータ収集

3. **アンサンブル学習**
   - 複数のモデルの投票による認識精度向上

## 技術的成果

### 実装された機能
1. **多段階認識システム**: CNN → Tesseract → Hash-basedの統合
2. **高度な文字分割**: 水平プロジェクション分析
3. **柔軟な前処理**: 白背景・黒背景の自動判定

### パフォーマンス
- **処理時間**: 0.158秒（8文字）
- **1文字あたり**: 約20ms

## 結論
文字分割の問題は解決しましたが、認識精度の向上には更なる改善が必要です。特に、実際のグラニュート文字テキスト画像での訓練データ収集と再学習が重要です。

## 次のステップ
1. 実際のグラニュート文字テキスト画像の収集
2. End-to-Endモデルの開発
3. リアルタイム認識のための最適化